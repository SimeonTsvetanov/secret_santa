<!doctype html>
<html lang="bg">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#dc2626" />
    <meta name="description" content="Secret Santa - Ğ¢ĞµĞ³Ğ»ĞµĞ½Ğµ Ğ½Ğ° Ğ¸Ğ¼ĞµĞ½Ğ° Ğ·Ğ° ĞºĞ¾Ğ»ĞµĞ´Ğ½Ğ¸ Ğ¿Ğ¾Ğ´Ğ°Ñ€ÑŠÑ†Ğ¸" />
    <link rel="manifest" href="manifest.json" />
    <title>Secret Santa ğŸ</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./sw.js', { scope: './' }).then(registration => {
            // Check for updates periodically
            setInterval(() => {
              registration.update();
            }, 60 * 60 * 1000); // Check every hour
            
            // Handle updates
            registration.onupdatefound = () => {
              const installingWorker = registration.installing;
              if (installingWorker == null) return;
              
              installingWorker.onstatechange = () => {
                if (installingWorker.state === 'installed') {
                  if (navigator.serviceWorker.controller) {
                    console.log('New content is available; please refresh.');
                    // Optional: Show a "Update available" toast instead of auto-reload
                    // For now, we rely on the controllerchange event below
                  } else {
                    console.log('Content is cached for offline use.');
                  }
                }
              };
            };
          });

          // Refresh functionality
          let refreshing;
          navigator.serviceWorker.addEventListener('controllerchange', () => {
            if (refreshing) return;
            window.location.reload();
            refreshing = true;
          });
        });
      }
    </script>
  </body>
</html>
